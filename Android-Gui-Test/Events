package com.example.jason_000.test4;

/**
 * Created by jason_000 on 11/1/2015.
 */
import android.content.Context;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.*;
public class Events
{
    private String name;
    private String category;
    private boolean holi;
    private int startingHour;
    private int startingMinute;
    private int endingMinute;
    private int endingHour;
    private String eventName;
    private String eventDescription;
    private String eventPlace;
    private String date;
    private String endingTimeOfDay;
    private String startingTimeOfDay;
    private File file;
    public Events(String n,String ePlace,String eDescription, String c,int sHour,int sMinute,String sTimeOfDay,String d,int eHour,int eMinute,String eTimeOfDay)
    {
        name=n;
        category=c;
        holi=false;
        startingHour=sHour;
        endingHour=eHour;
        startingMinute=sMinute;
        endingMinute=eMinute;
        eventName=n;
        eventDescription=eDescription;
        eventPlace=ePlace;
        date=d;
        endingTimeOfDay=eTimeOfDay;
        startingTimeOfDay=sTimeOfDay;
    }
    public Events(String n,String c)
    {
        name=n;
        category=c;
    }
    public Events()
    {
        name="";
        category="";
        holi=false;
    }
    public String getName()
    {
        return name;
    }
    public boolean getHoliday()
    {
        return    holi;
    }
    public void setHoliday()
    {
        holi=true;
    }
    public String getCategory()
    {
        return category;
    }

    public void setSHour(int h)
    {
        startingHour = h;
    }
    public int getSHour()
    {
        return startingHour;
    }

    public void setSMinute(int h)
    {
        startingMinute = h;
    }
    public int getSMinute()
    {
        return startingMinute;
    }

    public void setEHour(int h)
    {
        endingHour = h;
    }
    public int getEHour()
    {
        return endingHour;
    }
    public void setEMinute(int h)
    {
        endingMinute = h;
    }
    public int getEMinute()
    {
        return endingMinute;
    }

    public void setEName(String n)
    {
        eventName = n;
    }
    public String getEName()
    {
        return eventName;
    }

    public void setEDescription(String d)
    {
        eventDescription = d;
    }
    public String getEDescription()
    {
        return eventDescription;
    }

    public void setEPlace(String p)
    {
        eventPlace = p;
    }
    public String getEPlace()
    {
        return eventPlace;
    }

    public void setDate(String t)
    {
        date = t;
    }
    public String getDate()
    {
        return date;
    }

    public void setETimeOfDay(String t)
    {
        endingTimeOfDay = t;
    }
    public String getETimeOfDay()
    {
        return endingTimeOfDay;
    }
    public String getSTimeOfDay()
    {
        return startingTimeOfDay;
    }
    public void setSTimeOfDay(String t)
    {
        startingTimeOfDay = t;
    }
    public void setCategory(String t)
    {
        category = t;
    }



    public void addEvent(String n, String c,int sHour,int sMinute,int eHour,int eMinute,String eDescription,String ePlace,String d,String eTimeOfDay,String sTimeOfDay,Context con)
    {
        Events event = new Events();

        event.setEName(n);

        event.setCategory(c);

        event.setEPlace(ePlace);

        event.setEDescription(eDescription);

        event.setSHour(sHour);

        event.setSMinute(sMinute);

        event.setDate(d);

        event.setEHour(eHour);

        event.setEMinute(eMinute);

        event.setETimeOfDay(eTimeOfDay);

        event.setSTimeOfDay(sTimeOfDay);
        String[] write=d.split("/");
        String fileName = n+"_"+write[0]+"_"+write[1]+"_"+write[2]+"_"+".txt";
        try
        {
            FileOutputStream stream = con.openFileOutput(fileName,Context.MODE_PRIVATE);
            try
            {
                stream.write((""+ event.getEName()+"\n").getBytes());//Event name:
                stream.write(("," + event.getEPlace() + "\n").getBytes());//Event location:
                stream.write(("," + event.getEDescription() + "\n").getBytes());//Event description:
                stream.write(("," + event.getSHour() + "," + event.getSMinute() + "," + event.getSTimeOfDay() + "\n").getBytes());//Event start time:
                stream.write(("," + event.getDate() + "\n").getBytes());//Event date:
                stream.write(("," + event.getEHour() + "," + event.getEMinute() + "," + event.getETimeOfDay() + "\n").getBytes());//Event end time:
            } finally
            {
                stream.close();
            }
        }
        catch(IOException ex)
        {
            System.out.println(
                    "Error writing to file '"
                            + fileName + "'");
        }

    }
    public void editEvent(String n, String c,int sHour,int sMinute,int eHour,int eMinute,String eDescription,String ePlace,String d,String eTimeOfDay,String sTimeOfDay,Context con)
    {

        if(n.equals(""))
            n=getEName();

        if(c.equals(""))
            c=getCategory();

        if(ePlace.equals(""))
            ePlace=getEPlace();

        if(eDescription.equals(""))
            eDescription=getEDescription();

        if(sHour==0)
        {
            sHour = getSHour();
        }
        if(sMinute==78)
        {
            sMinute = getSMinute();
        }

        if(d.equals(""))
        {
            d = getDate();
        }

        if(eHour==0)
            eHour=getEHour();

        if(eMinute==78)
            eMinute=getEMinute();

        if(eTimeOfDay.equals("AM/PM"))
            eTimeOfDay=getETimeOfDay();

        if(sTimeOfDay.equals("AM/PM")) {
            sTimeOfDay = getSTimeOfDay();
        }
            deleteEvent(getFileName()+"_.txt",con);
            addEvent(n,c,sHour,sMinute,eHour,eMinute,eDescription,ePlace,d,eTimeOfDay,sTimeOfDay,con);
    }
    public String getFileName()
    {
        String[] write=date.split("/");
        String beforeFix=  ""+eventName+"_"+write[0]+"_"+write[1]+"_"+write[2]+"_"+".txt";
        String afterFix1=(beforeFix.split("_")[0].substring(0,beforeFix.split("_")[0].length()-1));
        String afterFix2=afterFix1+"_"+(beforeFix.split("_")[1].substring(0, beforeFix.split("_")[1].length()));
        String afterFix3=afterFix2+"_"+(beforeFix.split("_")[2].substring(0, beforeFix.split("_")[2].length()));
        String afterFix4=afterFix3+"_"+(beforeFix.split("_")[3].substring(0, beforeFix.split("_")[3].length() - 1));
        return afterFix4;
    }
    public boolean deleteEvent(String fn,Context con)
    {
        File dir = con.getFilesDir().getAbsoluteFile();
        File file = new File(dir, fn);
       return file.delete();

    }
}
